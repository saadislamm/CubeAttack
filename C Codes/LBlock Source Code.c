
#include <stdio.h>

unsigned char S[8][16] = {	{14,9,15,0,13,4,10,11,1,2,8,3,7,6,12,5},	//s0	
							{4,11,14,9,15,13,0,10,7,12,5,6,2,8,1,3},	//s1	
							{1,14,7,12,15,13,0,6,11,5,9,3,2,4,8,10},	//s2	
							{7,6,8,11,0,15,3,14,9,10,12,13,5,2,4,1},	//s3
							{14,5,15,0,7,2,12,13,1,8,4,9,11,10,6,3},	//s4
							{2,13,11,12,15,14,0,9,7,10,6,3,1,8,4,5},	//s5
							{11,9,4,14,0,15,10,13,6,12,5,7,3,8,1,2},	//s6
							{13,10,15,0,14,4,9,11,2,1,8,3,7,5,12,6}};	//s7	
unsigned char SK0[16] = {8,7,14,5,15,13,0,6,11,12,9,10,2,4,1,3};	//s8
unsigned char SK1[16] = {11,5,15,0,7,2,9,13,4,8,1,12,14,10,3,6};	//s9
unsigned int S0[256] = {
		0xb0d00000, 0x90d00000, 0x40d00000, 0xe0d00000, 0x00d00000, 0xf0d00000, 0xa0d00000, 0xd0d00000, 
		0x60d00000, 0xc0d00000, 0x50d00000, 0x70d00000, 0x30d00000, 0x80d00000, 0x10d00000, 0x20d00000, 
		0xb0a00000, 0x90a00000, 0x40a00000, 0xe0a00000, 0x00a00000, 0xf0a00000, 0xa0a00000, 0xd0a00000, 
		0x60a00000, 0xc0a00000, 0x50a00000, 0x70a00000, 0x30a00000, 0x80a00000, 0x10a00000, 0x20a00000, 
		0xb0f00000, 0x90f00000, 0x40f00000, 0xe0f00000, 0x00f00000, 0xf0f00000, 0xa0f00000, 0xd0f00000, 
		0x60f00000, 0xc0f00000, 0x50f00000, 0x70f00000, 0x30f00000, 0x80f00000, 0x10f00000, 0x20f00000, 
		0xb0000000, 0x90000000, 0x40000000, 0xe0000000, 0x00000000, 0xf0000000, 0xa0000000, 0xd0000000, 
		0x60000000, 0xc0000000, 0x50000000, 0x70000000, 0x30000000, 0x80000000, 0x10000000, 0x20000000, 
		0xb0e00000, 0x90e00000, 0x40e00000, 0xe0e00000, 0x00e00000, 0xf0e00000, 0xa0e00000, 0xd0e00000, 
		0x60e00000, 0xc0e00000, 0x50e00000, 0x70e00000, 0x30e00000, 0x80e00000, 0x10e00000, 0x20e00000, 
		0xb0400000, 0x90400000, 0x40400000, 0xe0400000, 0x00400000, 0xf0400000, 0xa0400000, 0xd0400000, 
		0x60400000, 0xc0400000, 0x50400000, 0x70400000, 0x30400000, 0x80400000, 0x10400000, 0x20400000, 
		0xb0900000, 0x90900000, 0x40900000, 0xe0900000, 0x00900000, 0xf0900000, 0xa0900000, 0xd0900000, 
		0x60900000, 0xc0900000, 0x50900000, 0x70900000, 0x30900000, 0x80900000, 0x10900000, 0x20900000, 
		0xb0b00000, 0x90b00000, 0x40b00000, 0xe0b00000, 0x00b00000, 0xf0b00000, 0xa0b00000, 0xd0b00000, 
		0x60b00000, 0xc0b00000, 0x50b00000, 0x70b00000, 0x30b00000, 0x80b00000, 0x10b00000, 0x20b00000, 
		0xb0200000, 0x90200000, 0x40200000, 0xe0200000, 0x00200000, 0xf0200000, 0xa0200000, 0xd0200000, 
		0x60200000, 0xc0200000, 0x50200000, 0x70200000, 0x30200000, 0x80200000, 0x10200000, 0x20200000, 
		0xb0100000, 0x90100000, 0x40100000, 0xe0100000, 0x00100000, 0xf0100000, 0xa0100000, 0xd0100000, 
		0x60100000, 0xc0100000, 0x50100000, 0x70100000, 0x30100000, 0x80100000, 0x10100000, 0x20100000, 
		0xb0800000, 0x90800000, 0x40800000, 0xe0800000, 0x00800000, 0xf0800000, 0xa0800000, 0xd0800000, 
		0x60800000, 0xc0800000, 0x50800000, 0x70800000, 0x30800000, 0x80800000, 0x10800000, 0x20800000, 
		0xb0300000, 0x90300000, 0x40300000, 0xe0300000, 0x00300000, 0xf0300000, 0xa0300000, 0xd0300000, 
		0x60300000, 0xc0300000, 0x50300000, 0x70300000, 0x30300000, 0x80300000, 0x10300000, 0x20300000, 
		0xb0700000, 0x90700000, 0x40700000, 0xe0700000, 0x00700000, 0xf0700000, 0xa0700000, 0xd0700000, 
		0x60700000, 0xc0700000, 0x50700000, 0x70700000, 0x30700000, 0x80700000, 0x10700000, 0x20700000, 
		0xb0500000, 0x90500000, 0x40500000, 0xe0500000, 0x00500000, 0xf0500000, 0xa0500000, 0xd0500000, 
		0x60500000, 0xc0500000, 0x50500000, 0x70500000, 0x30500000, 0x80500000, 0x10500000, 0x20500000, 
		0xb0c00000, 0x90c00000, 0x40c00000, 0xe0c00000, 0x00c00000, 0xf0c00000, 0xa0c00000, 0xd0c00000, 
		0x60c00000, 0xc0c00000, 0x50c00000, 0x70c00000, 0x30c00000, 0x80c00000, 0x10c00000, 0x20c00000, 
		0xb0600000, 0x90600000, 0x40600000, 0xe0600000, 0x00600000, 0xf0600000, 0xa0600000, 0xd0600000, 
		0x60600000, 0xc0600000, 0x50600000, 0x70600000, 0x30600000, 0x80600000, 0x10600000, 0x20600000};

unsigned int S1[256] = {
		0x0e020000, 0x05020000, 0x0f020000, 0x00020000, 0x07020000, 0x02020000, 0x0c020000, 0x0d020000, 
		0x01020000, 0x08020000, 0x04020000, 0x09020000, 0x0b020000, 0x0a020000, 0x06020000, 0x03020000, 
		0x0e0d0000, 0x050d0000, 0x0f0d0000, 0x000d0000, 0x070d0000, 0x020d0000, 0x0c0d0000, 0x0d0d0000, 
		0x010d0000, 0x080d0000, 0x040d0000, 0x090d0000, 0x0b0d0000, 0x0a0d0000, 0x060d0000, 0x030d0000, 
		0x0e0b0000, 0x050b0000, 0x0f0b0000, 0x000b0000, 0x070b0000, 0x020b0000, 0x0c0b0000, 0x0d0b0000, 
		0x010b0000, 0x080b0000, 0x040b0000, 0x090b0000, 0x0b0b0000, 0x0a0b0000, 0x060b0000, 0x030b0000, 
		0x0e0c0000, 0x050c0000, 0x0f0c0000, 0x000c0000, 0x070c0000, 0x020c0000, 0x0c0c0000, 0x0d0c0000, 
		0x010c0000, 0x080c0000, 0x040c0000, 0x090c0000, 0x0b0c0000, 0x0a0c0000, 0x060c0000, 0x030c0000, 
		0x0e0f0000, 0x050f0000, 0x0f0f0000, 0x000f0000, 0x070f0000, 0x020f0000, 0x0c0f0000, 0x0d0f0000, 
		0x010f0000, 0x080f0000, 0x040f0000, 0x090f0000, 0x0b0f0000, 0x0a0f0000, 0x060f0000, 0x030f0000, 
		0x0e0e0000, 0x050e0000, 0x0f0e0000, 0x000e0000, 0x070e0000, 0x020e0000, 0x0c0e0000, 0x0d0e0000, 
		0x010e0000, 0x080e0000, 0x040e0000, 0x090e0000, 0x0b0e0000, 0x0a0e0000, 0x060e0000, 0x030e0000, 
		0x0e000000, 0x05000000, 0x0f000000, 0x00000000, 0x07000000, 0x02000000, 0x0c000000, 0x0d000000, 
		0x01000000, 0x08000000, 0x04000000, 0x09000000, 0x0b000000, 0x0a000000, 0x06000000, 0x03000000, 
		0x0e090000, 0x05090000, 0x0f090000, 0x00090000, 0x07090000, 0x02090000, 0x0c090000, 0x0d090000, 
		0x01090000, 0x08090000, 0x04090000, 0x09090000, 0x0b090000, 0x0a090000, 0x06090000, 0x03090000, 
		0x0e070000, 0x05070000, 0x0f070000, 0x00070000, 0x07070000, 0x02070000, 0x0c070000, 0x0d070000, 
		0x01070000, 0x08070000, 0x04070000, 0x09070000, 0x0b070000, 0x0a070000, 0x06070000, 0x03070000, 
		0x0e0a0000, 0x050a0000, 0x0f0a0000, 0x000a0000, 0x070a0000, 0x020a0000, 0x0c0a0000, 0x0d0a0000, 
		0x010a0000, 0x080a0000, 0x040a0000, 0x090a0000, 0x0b0a0000, 0x0a0a0000, 0x060a0000, 0x030a0000, 
		0x0e060000, 0x05060000, 0x0f060000, 0x00060000, 0x07060000, 0x02060000, 0x0c060000, 0x0d060000, 
		0x01060000, 0x08060000, 0x04060000, 0x09060000, 0x0b060000, 0x0a060000, 0x06060000, 0x03060000, 
		0x0e030000, 0x05030000, 0x0f030000, 0x00030000, 0x07030000, 0x02030000, 0x0c030000, 0x0d030000, 
		0x01030000, 0x08030000, 0x04030000, 0x09030000, 0x0b030000, 0x0a030000, 0x06030000, 0x03030000, 
		0x0e010000, 0x05010000, 0x0f010000, 0x00010000, 0x07010000, 0x02010000, 0x0c010000, 0x0d010000, 
		0x01010000, 0x08010000, 0x04010000, 0x09010000, 0x0b010000, 0x0a010000, 0x06010000, 0x03010000, 
		0x0e080000, 0x05080000, 0x0f080000, 0x00080000, 0x07080000, 0x02080000, 0x0c080000, 0x0d080000, 
		0x01080000, 0x08080000, 0x04080000, 0x09080000, 0x0b080000, 0x0a080000, 0x06080000, 0x03080000, 
		0x0e040000, 0x05040000, 0x0f040000, 0x00040000, 0x07040000, 0x02040000, 0x0c040000, 0x0d040000, 
		0x01040000, 0x08040000, 0x04040000, 0x09040000, 0x0b040000, 0x0a040000, 0x06040000, 0x03040000, 
		0x0e050000, 0x05050000, 0x0f050000, 0x00050000, 0x07050000, 0x02050000, 0x0c050000, 0x0d050000, 
		0x01050000, 0x08050000, 0x04050000, 0x09050000, 0x0b050000, 0x0a050000, 0x06050000, 0x03050000};

unsigned int S2[256] = {
		0x00001070, 0x0000e070, 0x00007070, 0x0000c070, 0x0000f070, 0x0000d070, 0x00000070, 0x00006070, 
		0x0000b070, 0x00005070, 0x00009070, 0x00003070, 0x00002070, 0x00004070, 0x00008070, 0x0000a070, 
		0x00001060, 0x0000e060, 0x00007060, 0x0000c060, 0x0000f060, 0x0000d060, 0x00000060, 0x00006060, 
		0x0000b060, 0x00005060, 0x00009060, 0x00003060, 0x00002060, 0x00004060, 0x00008060, 0x0000a060, 
		0x00001080, 0x0000e080, 0x00007080, 0x0000c080, 0x0000f080, 0x0000d080, 0x00000080, 0x00006080, 
		0x0000b080, 0x00005080, 0x00009080, 0x00003080, 0x00002080, 0x00004080, 0x00008080, 0x0000a080, 
		0x000010b0, 0x0000e0b0, 0x000070b0, 0x0000c0b0, 0x0000f0b0, 0x0000d0b0, 0x000000b0, 0x000060b0, 
		0x0000b0b0, 0x000050b0, 0x000090b0, 0x000030b0, 0x000020b0, 0x000040b0, 0x000080b0, 0x0000a0b0, 
		0x00001000, 0x0000e000, 0x00007000, 0x0000c000, 0x0000f000, 0x0000d000, 0x00000000, 0x00006000, 
		0x0000b000, 0x00005000, 0x00009000, 0x00003000, 0x00002000, 0x00004000, 0x00008000, 0x0000a000, 
		0x000010f0, 0x0000e0f0, 0x000070f0, 0x0000c0f0, 0x0000f0f0, 0x0000d0f0, 0x000000f0, 0x000060f0, 
		0x0000b0f0, 0x000050f0, 0x000090f0, 0x000030f0, 0x000020f0, 0x000040f0, 0x000080f0, 0x0000a0f0, 
		0x00001030, 0x0000e030, 0x00007030, 0x0000c030, 0x0000f030, 0x0000d030, 0x00000030, 0x00006030, 
		0x0000b030, 0x00005030, 0x00009030, 0x00003030, 0x00002030, 0x00004030, 0x00008030, 0x0000a030, 
		0x000010e0, 0x0000e0e0, 0x000070e0, 0x0000c0e0, 0x0000f0e0, 0x0000d0e0, 0x000000e0, 0x000060e0, 
		0x0000b0e0, 0x000050e0, 0x000090e0, 0x000030e0, 0x000020e0, 0x000040e0, 0x000080e0, 0x0000a0e0, 
		0x00001090, 0x0000e090, 0x00007090, 0x0000c090, 0x0000f090, 0x0000d090, 0x00000090, 0x00006090, 
		0x0000b090, 0x00005090, 0x00009090, 0x00003090, 0x00002090, 0x00004090, 0x00008090, 0x0000a090, 
		0x000010a0, 0x0000e0a0, 0x000070a0, 0x0000c0a0, 0x0000f0a0, 0x0000d0a0, 0x000000a0, 0x000060a0, 
		0x0000b0a0, 0x000050a0, 0x000090a0, 0x000030a0, 0x000020a0, 0x000040a0, 0x000080a0, 0x0000a0a0, 
		0x000010c0, 0x0000e0c0, 0x000070c0, 0x0000c0c0, 0x0000f0c0, 0x0000d0c0, 0x000000c0, 0x000060c0, 
		0x0000b0c0, 0x000050c0, 0x000090c0, 0x000030c0, 0x000020c0, 0x000040c0, 0x000080c0, 0x0000a0c0, 
		0x000010d0, 0x0000e0d0, 0x000070d0, 0x0000c0d0, 0x0000f0d0, 0x0000d0d0, 0x000000d0, 0x000060d0, 
		0x0000b0d0, 0x000050d0, 0x000090d0, 0x000030d0, 0x000020d0, 0x000040d0, 0x000080d0, 0x0000a0d0, 
		0x00001050, 0x0000e050, 0x00007050, 0x0000c050, 0x0000f050, 0x0000d050, 0x00000050, 0x00006050, 
		0x0000b050, 0x00005050, 0x00009050, 0x00003050, 0x00002050, 0x00004050, 0x00008050, 0x0000a050, 
		0x00001020, 0x0000e020, 0x00007020, 0x0000c020, 0x0000f020, 0x0000d020, 0x00000020, 0x00006020, 
		0x0000b020, 0x00005020, 0x00009020, 0x00003020, 0x00002020, 0x00004020, 0x00008020, 0x0000a020, 
		0x00001040, 0x0000e040, 0x00007040, 0x0000c040, 0x0000f040, 0x0000d040, 0x00000040, 0x00006040, 
		0x0000b040, 0x00005040, 0x00009040, 0x00003040, 0x00002040, 0x00004040, 0x00008040, 0x0000a040, 
		0x00001010, 0x0000e010, 0x00007010, 0x0000c010, 0x0000f010, 0x0000d010, 0x00000010, 0x00006010, 
		0x0000b010, 0x00005010, 0x00009010, 0x00003010, 0x00002010, 0x00004010, 0x00008010, 0x0000a010};

unsigned int S3[256] = {
		0x00000e04, 0x00000904, 0x00000f04, 0x00000004, 0x00000d04, 0x00000404, 0x00000a04, 0x00000b04, 
		0x00000104, 0x00000204, 0x00000804, 0x00000304, 0x00000704, 0x00000604, 0x00000c04, 0x00000504, 
		0x00000e0b, 0x0000090b, 0x00000f0b, 0x0000000b, 0x00000d0b, 0x0000040b, 0x00000a0b, 0x00000b0b, 
		0x0000010b, 0x0000020b, 0x0000080b, 0x0000030b, 0x0000070b, 0x0000060b, 0x00000c0b, 0x0000050b, 
		0x00000e0e, 0x0000090e, 0x00000f0e, 0x0000000e, 0x00000d0e, 0x0000040e, 0x00000a0e, 0x00000b0e, 
		0x0000010e, 0x0000020e, 0x0000080e, 0x0000030e, 0x0000070e, 0x0000060e, 0x00000c0e, 0x0000050e, 
		0x00000e09, 0x00000909, 0x00000f09, 0x00000009, 0x00000d09, 0x00000409, 0x00000a09, 0x00000b09, 
		0x00000109, 0x00000209, 0x00000809, 0x00000309, 0x00000709, 0x00000609, 0x00000c09, 0x00000509, 
		0x00000e0f, 0x0000090f, 0x00000f0f, 0x0000000f, 0x00000d0f, 0x0000040f, 0x00000a0f, 0x00000b0f, 
		0x0000010f, 0x0000020f, 0x0000080f, 0x0000030f, 0x0000070f, 0x0000060f, 0x00000c0f, 0x0000050f, 
		0x00000e0d, 0x0000090d, 0x00000f0d, 0x0000000d, 0x00000d0d, 0x0000040d, 0x00000a0d, 0x00000b0d, 
		0x0000010d, 0x0000020d, 0x0000080d, 0x0000030d, 0x0000070d, 0x0000060d, 0x00000c0d, 0x0000050d, 
		0x00000e00, 0x00000900, 0x00000f00, 0x00000000, 0x00000d00, 0x00000400, 0x00000a00, 0x00000b00, 
		0x00000100, 0x00000200, 0x00000800, 0x00000300, 0x00000700, 0x00000600, 0x00000c00, 0x00000500, 
		0x00000e0a, 0x0000090a, 0x00000f0a, 0x0000000a, 0x00000d0a, 0x0000040a, 0x00000a0a, 0x00000b0a, 
		0x0000010a, 0x0000020a, 0x0000080a, 0x0000030a, 0x0000070a, 0x0000060a, 0x00000c0a, 0x0000050a, 
		0x00000e07, 0x00000907, 0x00000f07, 0x00000007, 0x00000d07, 0x00000407, 0x00000a07, 0x00000b07, 
		0x00000107, 0x00000207, 0x00000807, 0x00000307, 0x00000707, 0x00000607, 0x00000c07, 0x00000507, 
		0x00000e0c, 0x0000090c, 0x00000f0c, 0x0000000c, 0x00000d0c, 0x0000040c, 0x00000a0c, 0x00000b0c, 
		0x0000010c, 0x0000020c, 0x0000080c, 0x0000030c, 0x0000070c, 0x0000060c, 0x00000c0c, 0x0000050c, 
		0x00000e05, 0x00000905, 0x00000f05, 0x00000005, 0x00000d05, 0x00000405, 0x00000a05, 0x00000b05, 
		0x00000105, 0x00000205, 0x00000805, 0x00000305, 0x00000705, 0x00000605, 0x00000c05, 0x00000505, 
		0x00000e06, 0x00000906, 0x00000f06, 0x00000006, 0x00000d06, 0x00000406, 0x00000a06, 0x00000b06, 
		0x00000106, 0x00000206, 0x00000806, 0x00000306, 0x00000706, 0x00000606, 0x00000c06, 0x00000506, 
		0x00000e02, 0x00000902, 0x00000f02, 0x00000002, 0x00000d02, 0x00000402, 0x00000a02, 0x00000b02, 
		0x00000102, 0x00000202, 0x00000802, 0x00000302, 0x00000702, 0x00000602, 0x00000c02, 0x00000502, 
		0x00000e08, 0x00000908, 0x00000f08, 0x00000008, 0x00000d08, 0x00000408, 0x00000a08, 0x00000b08, 
		0x00000108, 0x00000208, 0x00000808, 0x00000308, 0x00000708, 0x00000608, 0x00000c08, 0x00000508, 
		0x00000e01, 0x00000901, 0x00000f01, 0x00000001, 0x00000d01, 0x00000401, 0x00000a01, 0x00000b01, 
		0x00000101, 0x00000201, 0x00000801, 0x00000301, 0x00000701, 0x00000601, 0x00000c01, 0x00000501, 
		0x00000e03, 0x00000903, 0x00000f03, 0x00000003, 0x00000d03, 0x00000403, 0x00000a03, 0x00000b03, 
		0x00000103, 0x00000203, 0x00000803, 0x00000303, 0x00000703, 0x00000603, 0x00000c03, 0x00000503};

unsigned char S4[256] = {
			0xb8, 0xb7, 0xbe, 0xb5, 0xbf, 0xbd, 0xb0, 0xb6,	0xbb, 0xbc, 0xb9, 0xba, 0xb2, 0xb4, 0xb1, 0xb3,
			0x58, 0x57, 0x5e, 0x55, 0x5f, 0x5d, 0x50, 0x56,	0x5b, 0x5c, 0x59, 0x5a, 0x52, 0x54, 0x51, 0x53,
			0xf8, 0xf7, 0xfe, 0xf5, 0xff, 0xfd, 0xf0, 0xf6,	0xfb, 0xfc, 0xf9, 0xfa, 0xf2, 0xf4, 0xf1, 0xf3,
			0x08, 0x07, 0x0e, 0x05, 0x0f, 0x0d, 0x00, 0x06,	0x0b, 0x0c, 0x09, 0x0a, 0x02, 0x04, 0x01, 0x03,
			0x78, 0x77, 0x7e, 0x75, 0x7f, 0x7d, 0x70, 0x76,	0x7b, 0x7c, 0x79, 0x7a, 0x72, 0x74, 0x71, 0x73,
			0x28, 0x27, 0x2e, 0x25, 0x2f, 0x2d, 0x20, 0x26,	0x2b, 0x2c, 0x29, 0x2a, 0x22, 0x24, 0x21, 0x23,
			0x98, 0x97, 0x9e, 0x95, 0x9f, 0x9d, 0x90, 0x96,	0x9b, 0x9c, 0x99, 0x9a, 0x92, 0x94, 0x91, 0x93,
			0xd8, 0xd7, 0xde, 0xd5, 0xdf, 0xdd, 0xd0, 0xd6,	0xdb, 0xdc, 0xd9, 0xda, 0xd2, 0xd4, 0xd1, 0xd3,
			0x48, 0x47, 0x4e, 0x45, 0x4f, 0x4d, 0x40, 0x46,	0x4b, 0x4c, 0x49, 0x4a, 0x42, 0x44, 0x41, 0x43,
			0x88, 0x87, 0x8e, 0x85, 0x8f, 0x8d, 0x80, 0x86,	0x8b, 0x8c, 0x89, 0x8a, 0x82, 0x84, 0x81, 0x83,
			0x18, 0x17, 0x1e, 0x15, 0x1f, 0x1d, 0x10, 0x16,	0x1b, 0x1c, 0x19, 0x1a, 0x12, 0x14, 0x11, 0x13,
			0xc8, 0xc7, 0xce, 0xc5, 0xcf, 0xcd, 0xc0, 0xc6,	0xcb, 0xcc, 0xc9, 0xca, 0xc2, 0xc4, 0xc1, 0xc3,
			0xe8, 0xe7, 0xee, 0xe5, 0xef, 0xed, 0xe0, 0xe6,	0xeb, 0xec, 0xe9, 0xea, 0xe2, 0xe4, 0xe1, 0xe3,
			0xa8, 0xa7, 0xae, 0xa5, 0xaf, 0xad, 0xa0, 0xa6,	0xab, 0xac, 0xa9, 0xaa, 0xa2, 0xa4, 0xa1, 0xa3,
			0x38, 0x37, 0x3e, 0x35, 0x3f, 0x3d, 0x30, 0x36,	0x3b, 0x3c, 0x39, 0x3a, 0x32, 0x34, 0x31, 0x33,
			0x68, 0x67, 0x6e, 0x65, 0x6f, 0x6d, 0x60, 0x66, 0x6b, 0x6c, 0x69, 0x6a, 0x62, 0x64, 0x61, 0x63};

unsigned char P[8] = {1,3,0,2,5,7,4,6};

void LBlockKeySchedule(unsigned char *key, unsigned int *subkey)
{
	int i, j;
	unsigned char temp[10], temp1[10];

	subkey[0] = (key[0] << 24) ^ (key[1] << 16) ^ (key[2] << 8) ^ key[3];

	for (i = 0; i < 10; i++)
	{
		temp[i] = (key[(i + 3) % 10] << 5) ^ (key[(i + 4) % 10] >> 3);
	}
	temp[0] = S4[temp[0]];
	temp[4] ^= 0x1 << 6;
	subkey[1] = (temp[0] << 24) ^ (temp[1] << 16) ^ (temp[2] << 8) ^ temp[3];

	for (i = 2; i <32; i++)
	{	
		for (j = 0; j < 10; j++)
		{
			temp1[j] = temp[j];
		}
		for (j = 0; j < 10; j++)
		{
			temp[j] = (temp1[(j + 3) % 10] << 5) ^ (temp1[(j + 4) % 10] >> 3);
		}
		temp[0] = S4[temp[0]];
		temp[3] ^= i >> 2;
		temp[4] ^= (i & 0x3) << 6;
		subkey[i] = (temp[0] << 24) ^ (temp[1] << 16) ^ (temp[2] << 8) ^ temp[3];
	}

	return;
}

void LBlockEncrypt(unsigned char *plain, unsigned char *cipher, unsigned char *key)
{
	int i;
	unsigned int XL, XR, temp, temp1;
	unsigned int Subkey[32];

	LBlockKeySchedule(key, Subkey);

	XL = (plain[0] << 24) ^ (plain[1] << 16) ^ (plain[2] << 8) ^ plain[3];
	XR = (plain[4] << 24) ^ (plain[5] << 16) ^ (plain[6] << 8) ^ plain[7];

	for (i = 0; i < 32; i++)
	{
		temp = XL ^ Subkey[i];
		temp1 = S0[temp >> 24] ^ S1[(temp >> 16) & 0xff] ^ S2[(temp >> 8) & 0xff] ^ S3[temp & 0xff] ^ (XR << 8) ^ (XR >> 24);
		XR = XL;
		XL = temp1;
	}
	
	cipher[0] = XR >> 24;
	cipher[1] = (XR >> 16) & 0xff;
	cipher[2] = (XR >> 8) & 0xff;
	cipher[3] = XR & 0xff;
	cipher[4] = XL >> 24;
	cipher[5] = (XL >> 16) & 0xff;
	cipher[6] = (XL >> 8) & 0xff;
	cipher[7] = XL & 0xff;

	return;
}

void LBlockDecrypt(unsigned char *cipher, unsigned char *plain, unsigned char *key)
{
	int i;
	unsigned int XL, XR, temp, temp1;
	unsigned int Subkey[32];

	LBlockKeySchedule(key, Subkey);

	XL = (cipher[0] << 24) ^ (cipher[1] << 16) ^ (cipher[2] << 8) ^ cipher[3];
	XR = (cipher[4] << 24) ^ (cipher[5] << 16) ^ (cipher[6] << 8) ^ cipher[7];

	for (i = 31; i >= 0; i--)
	{
		temp = XL ^ Subkey[i];
		temp1 = S0[temp >> 24] ^ S1[(temp >> 16) & 0xff] ^ S2[(temp >> 8) & 0xff] ^ S3[temp & 0xff];
		temp = XL;
		XL = ((temp1 ^ XR) >> 8) ^ ((temp1 ^ XR) << 24);
		XR = temp;
	}

	plain[0] = XR >> 24;
	plain[1] = (XR >> 16) & 0xff;
	plain[2] = (XR >> 8) & 0xff;
	plain[3] = XR & 0xff;
	plain[4] = XL >> 24;
	plain[5] = (XL >> 16) & 0xff;
	plain[6] = (XL >> 8) & 0xff;
	plain[7] = XL & 0xff;

	return;
}


void main()
{
//	unsigned char plain[8] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
	unsigned char plain[8] = {0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef};
	unsigned char cipher[8];
//	unsigned char key[10] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
	unsigned char key[10] = {0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef, 0xfe, 0xdc};
	int i, j;

	LBlockEncrypt(plain, cipher, key);
	for (i = 0; i <8; i++)
	{
		printf("%02x, ", cipher[i]);
	}
	printf("\n\n");

	LBlockDecrypt(cipher, plain, key);
	for (i = 0; i <8; i++)
	{
		printf("%02x, ", plain[i]);
	}
	printf("\n");

	return;
}


